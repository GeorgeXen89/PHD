# 🔩 screw_identifier – Αναγνώριση Βίδας από Νέφος Σημείων

Το `screw_identifier` είναι ένα Python εργαλείο για **αυτόματη αναγνώριση τυποποιημένης βίδας** από `.ply` point cloud και σύνδεση με βάση δεδομένων McMaster-Carr για λήψη CAD μοντέλου (.STEP).

📍 Αναπτύχθηκε στο πλαίσιο διδακτορικής έρευνας με αντικείμενο το reverse engineering με βάση νέφη σημείων.

---

## 🎯 Τι κάνει

Δεδομένου ενός `.ply` αρχείου που περιέχει νέφος σημείων από σκαναρισμένη βίδα, το πρόγραμμα:

1. Εκτελεί **voxel downsampling** και υπολογισμό normal vectors.
2. Κρατά το **κεντρικό τμήμα** της βίδας (χωρίς κεφάλι και άκρη).
3. Εφαρμόζει **RANSAC** για ανίχνευση κυλινδρικής γεωμετρίας και υπολογίζει τη διάμετρο.
4. Υπολογίζει το **μήκος της βίδας**.
5. Εκτιμά αν η βίδα είναι **πλήρως ή μερικώς σπειρωμένη**.
6. Αντιστοιχεί με πλησιέστερο **τυποποιημένο τύπο** (M5, M6, M10 κ.λπ.).
7. Παράγει σύνδεσμο **McMaster-Carr** για να κατεβάσεις το CAD αρχείο.

---

## 📁 Δομή Αρχείων

| Αρχείο | Λειτουργία |
|--------|------------|
| `main.py` | Κύριο πρόγραμμα. Φορτώνει .ply, εκτελεί αναγνώριση, εμφανίζει αποτελέσματα |
| `io_utils.py` | Φορτώνει και επεξεργάζεται το νέφος σημείων |
| `geometry_analysis.py` | Υπολογίζει διάμετρο με RANSAC και συνολικό μήκος |
| `thread_classifier.py` | Εκτιμά αν η βίδα είναι "Fully" ή "Partial" |
| `standard_matcher.py` | Ταιριάζει τις διαστάσεις με κοντινό ISO/McMaster τύπο και δημιουργεί URL |

---

## ▶️ Εκτέλεση

1. Βεβαιώσου ότι είσαι στο κατάλληλο περιβάλλον:
   ```bash
   conda activate screw_env
   ```

2. Τρέξε:
   ```bash
   python main.py
   ```

3. Αν χρειάζεται, άλλαξε το `PLY_FILE` στο `main.py` για να δείχνει σε δικό σου αρχείο.

---

## ✅ Τρέχουσα Κατάσταση

- Πολύ καλή ακρίβεια σε **fully threaded βίδες**.
- Αναξιόπιστο αποτέλεσμα σε **partial thread** λόγω ασυνέχειας γεωμετρίας.
- Από 4 επαναλήψεις, οι 3 παρήγαγαν σωστή διάμετρο (~9.6mm για M10), 1 έδωσε εκτός ορίων (~8mm).

---

## 🚀 Προτάσεις Βελτίωσης

### 1. 📐 Βελτίωση RANSAC:
- Να εφαρμόζεται **πάνω σε filtered περιοχή** όπου απομακρύνονται τα threads.
- Ενσωμάτωση πολλαπλών RANSAC runs με **στατιστική αποδοχή (π.χ. median)**.

### 2. 🤖 Αναγνώριση Σπειρώματος με ML:
- Αντικατάσταση του απλού heuristic με **ML ταξινομητή** (π.χ. Random Forest ή SVM) βασισμένο σε μήκος, inliers, καμπυλότητα κ.ά.

### 3. 🧠 Ανίχνευση pitch (βήματος):
- Χρήση **FFT** κατά μήκος Z-άξονα για εύρεση συχνότητας εμφάνισης "κορυφών" σπειρώματος.

### 4. 🧱 Database Matching:
- Προσθήκη πίνακα `.csv` με ISO διαστάσεις για **ακριβή ταυτοποίηση**.
- Έλεγχος και **κατά DIN/ISO προδιαγραφή** (π.χ. DIN 933 vs 931).

### 5. 📊 Output σε αρχείο:
- Εξαγωγή `.csv` ή `.json` με:
  - Διάμετρο
  - Μήκος
  - Τύπο σπειρώματος
  - Matching type
  - URL

### 6. 🖼️ Οπτικοποίηση & GUI:
- Προσθήκη `view_ply.py` για απλή 3D οπτικοποίηση.
- Μελλοντικά: Web interface με **Streamlit**.

---

## 📌 Απαιτήσεις
```bash
pip install open3d numpy pyransac3d
```

---

## 👤 Συντάκτης
Γιώργος Ξενάκης  
Διδακτορική Έρευνα – Αντίστροφος Σχεδιασμός με νέφη σημείων (.ply)  
2025 – screw_identifier v1.0  
